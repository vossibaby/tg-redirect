<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>–ü–µ—Ä–µ—Ö–æ–¥‚Ä¶</title>
<style>
body{display:flex;align-items:center;justify-content:center;height:100vh;margin:0;font-family:sans-serif;background:#f5f5f5;color:#333}
.loader{width:40px;height:40px;border:4px solid #ddd;border-top-color:#2AABEE;border-radius:50%;animation:spin .8s linear infinite;margin-right:12px}
@keyframes spin{to{transform:rotate(360deg)}}
.debug{text-align:left;padding:40px;font-family:monospace;font-size:14px;line-height:2.2;max-width:600px}
.debug b{color:#333} .red{color:red} .green{color:green}
</style>
</head>
<body>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê –ù–ê–°–¢–†–û–ô–ö–ò ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
var BOT      = 'potokbz_bot';
var MAX_WAIT = 5000; // 5 —Å–µ–∫ –æ–∂–∏–¥–∞–Ω–∏–µ –ú–µ—Ç—Ä–∏–∫–∏
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// --- –£—Ç–∏–ª–∏—Ç—ã ---
function getParam(name) {
    var r = new RegExp('[?&]' + name + '=([^&]*)');
    var m = r.exec(location.search);
    return m ? decodeURIComponent(m[1]) : '';
}
function getCookie(name) {
    var m = document.cookie.match(new RegExp('(?:^|; )' + name + '=([^;]*)'));
    return m ? decodeURIComponent(m[1]) : '';
}

// --- –ü—Ä–æ–≤–µ—Ä—è–µ–º debug –°–†–ê–ó–£, –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ –ú–µ—Ç—Ä–∏–∫–∏ ---
var IS_DEBUG = (getParam('debug') === '1');

if (!IS_DEBUG) {
    // –û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ª–æ–∞–¥–µ—Ä
    document.body.innerHTML = '<div class="loader"></div>–ü–µ—Ä–µ—Ö–æ–¥ –≤ Telegram‚Ä¶';
} else {
    // Debug ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥–ª—É—à–∫—É –ø–æ–∫–∞ –∂–¥—ë–º –ú–µ—Ç—Ä–∏–∫—É
    document.body.innerHTML = '<div class="debug"><h2>üîç Debug ‚Äî –∂–¥—ë–º –ú–µ—Ç—Ä–∏–∫—É...</h2></div>';
}

// --- –ó–∞–≥—Ä—É–∂–∞–µ–º –ú–µ—Ç—Ä–∏–∫—É –ü–û–°–õ–ï –ø—Ä–æ–≤–µ—Ä–∫–∏ debug ---
(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
(window,document,"script","https://mc.yandex.ru/metrika/tag.js","ym");
ym(97479917,"init",{clickmap:true,trackLinks:true,accurateTrackBounce:true});

// --- –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ ---
var done = false;

function buildStart(cid) {
    var parts = [];
    var keys = [
        ['utm_source',   'src'],
        ['utm_medium',   'med'],
        ['utm_campaign', 'cmp'],
        ['utm_content',  'cnt']
    ];
    for (var i = 0; i < keys.length; i++) {
        var val = getParam(keys[i][0]).replace(/[^a-zA-Z0-9_]/g, '');
        if (val) parts.push(keys[i][1] + '_' + val);
    }
    cid = (cid || '').replace(/[^a-zA-Z0-9_]/g, '');
    if (cid) parts.push('cid_' + cid);
    return parts.length > 0 ? parts.join('-').slice(0, 64).replace(/[-_]$/, '') : '';
}

function finish(clientId) {
    if (done) return;
    done = true;

    var cid = clientId || getCookie('_ym_uid') || '';
    var start = buildStart(cid);

    if (IS_DEBUG) {
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ —ç–∫—Ä–∞–Ω–µ
        var ok = '<span class="green">‚úÖ ';
        var no = '<span class="red">‚ùå –ü–£–°–¢–û';
        document.body.innerHTML =
            '<div class="debug">' +
            '<h2>üîç Debug –Ω—É–ª–µ–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã</h2>' +
            '<b>utm_source:</b> '   + (getParam('utm_source')   || '‚Äî') + '<br>' +
            '<b>utm_medium:</b> '   + (getParam('utm_medium')   || '‚Äî') + '<br>' +
            '<b>utm_campaign:</b> ' + (getParam('utm_campaign') || '‚Äî') + '<br>' +
            '<b>utm_content:</b> '  + (getParam('utm_content')  || '‚Äî') + '<br><br>' +
            '<b>–ö—É–∫–∞ _ym_uid:</b> '  + (getCookie('_ym_uid') ? ok + getCookie('_ym_uid') + '</span>' : no + '</span>') + '<br>' +
            '<b>getClientID:</b> '   + (clientId               ? ok + clientId + '</span>'            : no + '</span>') + '<br>' +
            '<b>utm_term (–∏—Ç–æ–≥):</b> ' + (cid                  ? ok + cid + '</span>'                 : no + '</span>') + '<br><br>' +
            '<b>start=</b> ' + (start || '<span class="red">–ø—É—Å—Ç–æ</span>') + '<br><br>' +
            (start
                ? '<b>–°—Å—ã–ª–∫–∞:</b><br><a href="https://t.me/'+BOT+'?start='+start+'">https://t.me/'+BOT+'?start='+start+'</a>'
                : '<b>–°—Å—ã–ª–∫–∞:</b><br><a href="https://t.me/'+BOT+'">https://t.me/'+BOT+'</a> (–æ–±—ã—á–Ω—ã–π /start)') +
            '</div>';
        return;
    }

    // –û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º ‚Äî —Ä–µ–¥–∏—Ä–µ–∫—Ç
    if (start) {
        location.href = 'https://t.me/' + BOT + '?start=' + start;
    } else {
        location.href = 'https://t.me/' + BOT;
    }
}

// --- –ñ–¥—ë–º –ú–µ—Ç—Ä–∏–∫—É ---
var waited = 0, iv = 200;
var timer = setInterval(function() {
    waited += iv;

    // –ü—Ä–æ–±—É–µ–º –∫—É–∫—É
    if (getCookie('_ym_uid')) {
        clearInterval(timer);
        finish(getCookie('_ym_uid'));
        return;
    }

    // –ü—Ä–æ–±—É–µ–º API
    if (typeof ym === 'function') {
        ym(97479917, 'getClientID', function(cid) {
            if (cid) { clearInterval(timer); finish(cid); }
        });
    }

    // –¢–∞–π–º–∞—É—Ç ‚Äî —É—Ö–æ–¥–∏–º –±–µ–∑ cid
    if (waited >= MAX_WAIT) {
        clearInterval(timer);
        finish('');
    }
}, iv);
</script>
</body>
</html>