<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ĞŸĞµÑ€ĞµÑ…Ğ¾Ğ´â€¦</title>
<style>
body{display:flex;align-items:center;justify-content:center;height:100vh;margin:0;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:#f0f2f5;color:#333}
.wrap{text-align:center}
.loader{width:48px;height:48px;border:4px solid #e0e0e0;border-top-color:#2AABEE;border-radius:50%;animation:spin .8s linear infinite;margin:0 auto 20px}
@keyframes spin{to{transform:rotate(360deg)}}
.title{font-size:18px;font-weight:600;color:#222;margin-bottom:8px}
.sub{font-size:14px;color:#888}
.tg-icon{font-size:36px;margin-bottom:16px}
.debug{text-align:left;padding:40px;font-family:monospace;font-size:14px;line-height:2.2;max-width:700px}
.red{color:red} .green{color:green}
</style>
</head>
<body>
<div id="content">
<div class="wrap">
    <div class="tg-icon">âœˆï¸</div>
    <div class="loader"></div>
    <div class="title">ĞŸĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ¸Ğ¼ Ğ² Telegram</div>
    <div class="sub">ĞŸĞ¾Ğ´Ğ¾Ğ¶Ğ´Ğ¸Ñ‚Ğµ Ğ¿Ğ°Ñ€Ñƒ ÑĞµĞºÑƒĞ½Ğ´â€¦</div>
</div>
</div>

<!-- Ğ¯Ğ½Ğ´ĞµĞºÑ.ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ° -->
<script>
try {
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t);a=e.getElementsByTagName(t)[0];
    k.async=1;k.src=r;if(a&&a.parentNode){a.parentNode.insertBefore(k,a)}else{e.head.appendChild(k)}})
    (window,document,"script","https://mc.yandex.ru/metrika/tag.js","ym");
    ym(97479917,"init",{clickmap:true,trackLinks:true,accurateTrackBounce:true});
} catch(e) {}
</script>

<script>
(function() {
    // â•â•â•â•â•â•â•â•â•â•â• ĞĞĞ¡Ğ¢Ğ ĞĞ™ĞšĞ˜ â•â•â•â•â•â•â•â•â•â•â•
    var REDIRECT_URL = 'https://sbsite.pro/utmdirect_1';
    var MAX_WAIT     = 5000;
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    var done = false;

    function getParam(name) {
        var r = new RegExp('[?&]' + name + '=([^&]*)');
        var m = r.exec(location.search);
        return m ? decodeURIComponent(m[1]) : '';
    }

    function getCookie(name) {
        var m = document.cookie.match(new RegExp('(?:^|; )' + name + '=([^;]*)'));
        return m ? decodeURIComponent(m[1]) : '';
    }

    var IS_DEBUG = (getParam('debug') === '1');

    if (IS_DEBUG) {
        document.getElementById('content').innerHTML =
            '<div class="debug"><h2>ğŸ” Debug â€” Ğ¶Ğ´Ñ‘Ğ¼ ĞœĞµÑ‚Ñ€Ğ¸ĞºÑƒ (Ğ´Ğ¾ 5 ÑĞµĞº)...</h2></div>';
    }

    function finish(clientId) {
        if (done) return;
        done = true;

        var cid = clientId || getCookie('_ym_uid') || '';

        // Ğ¡Ğ¾Ğ±Ğ¸Ñ€Ğ°ĞµĞ¼ UTM-Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹
        var utmSource   = getParam('utm_source');
        var utmMedium   = getParam('utm_medium');
        var utmCampaign = getParam('utm_campaign');
        var utmContent  = getParam('utm_content');
        var utmTerm     = cid; // utm_term = _ym_uid

        // Ğ¤Ğ¾Ñ€Ğ¼Ğ¸Ñ€ÑƒĞµĞ¼ URL Ñ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ°Ğ¼Ğ¸
        var params = [];
        if (utmSource)   params.push('utm_source='   + encodeURIComponent(utmSource));
        if (utmMedium)   params.push('utm_medium='   + encodeURIComponent(utmMedium));
        if (utmCampaign) params.push('utm_campaign=' + encodeURIComponent(utmCampaign));
        if (utmContent)  params.push('utm_content='  + encodeURIComponent(utmContent));
        if (utmTerm)     params.push('utm_term='     + encodeURIComponent(utmTerm));

        var finalUrl = REDIRECT_URL;
        if (params.length > 0) {
            finalUrl += '?' + params.join('&');
        }

        if (IS_DEBUG) {
            var ok = '<span class="green">âœ… ';
            var no = '<span class="red">âŒ ĞŸĞ£Ğ¡Ğ¢Ğ</span>';
            document.getElementById('content').innerHTML =
                '<div class="debug">' +
                '<h2>ğŸ” Debug Ğ½ÑƒĞ»ĞµĞ²Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹</h2>' +
                '<b>utm_source:</b> '   + (utmSource   || 'â€”') + '<br>' +
                '<b>utm_medium:</b> '   + (utmMedium   || 'â€”') + '<br>' +
                '<b>utm_campaign:</b> ' + (utmCampaign || 'â€”') + '<br>' +
                '<b>utm_content:</b> '  + (utmContent  || 'â€”') + '<br>' +
                '<b>utm_term (_ym_uid):</b> ' + (cid ? ok + cid + '</span>' : no) + '<br><br>' +
                '<b>ĞšÑƒĞºĞ° _ym_uid:</b> '  + (getCookie('_ym_uid') ? ok + getCookie('_ym_uid') + '</span>' : no) + '<br>' +
                '<b>getClientID:</b> '   + (clientId             ? ok + clientId + '</span>'              : no) + '<br><br>' +
                '<b>Ğ˜Ñ‚Ğ¾Ğ³Ğ¾Ğ²Ñ‹Ğ¹ URL:</b><br><a href="' + finalUrl + '" style="word-break:break-all">' + finalUrl + '</a>' +
                '</div>';
            return;
        }

        location.href = finalUrl;
    }

    // Ğ–Ğ´Ñ‘Ğ¼ ĞœĞµÑ‚Ñ€Ğ¸ĞºÑƒ
    var waited = 0, iv = 200;
    var timer = setInterval(function() {
        waited += iv;
        try {
            if (getCookie('_ym_uid')) {
                clearInterval(timer);
                finish(getCookie('_ym_uid'));
                return;
            }
            if (typeof ym === 'function') {
                ym(97479917, 'getClientID', function(cid) {
                    if (cid) { clearInterval(timer); finish(cid); }
                });
            }
        } catch(e) {}
        if (waited >= MAX_WAIT) {
            clearInterval(timer);
            finish('');
        }
    }, iv);

    // Ğ–Ñ‘ÑÑ‚ĞºĞ¸Ğ¹ fallback
    setTimeout(function() { finish(''); }, MAX_WAIT + 2000);
})();
</script>
</body>
</html>
